\section{Antenna Design and Beamforming Strategy}
\label{sec:antennas}

\todo{check these 2 papers: https://ieeexplore.ieee.org/document/7803878 and https://ieeexplore.ieee.org/document/8250021}


% Perhaps in the design section talk about the modelling of antennas



% BELOW ARE BEAM FORMING STRATEGIES!


After obtaining CSI, we require a strategy to form beams. A beam is formed by changing the phases and amplitudes of the signals fed to each antenna element. The beamforming strategy used to direct the beams is beam-steering \todo{citation balanis? AND APPENDIX!!} \bb{See appendix X to understand how beam-steering works and how to obtain a precoder from an array geometry that maximises the constructive coherent interference of the signal in a given direction}. 

To compute a beam-steering vector, only the relative position of the elements in the array matters, and only the phases of the vector weights change. However, varying solely phases has a significant implementation benefit of requiring only analogue phase-shifters. If amplitudes vary also, then the change must be done digitally, requiring a complete RF chain per antenna element \cite{8744505}

\begin{comment} % This is not true: there are several power amplifiers on the way and changing the amplitude is quite hard. 
To only way of changing the amplitudes of the weights without requiring one RF chain per antenna element is to use windows (or tapers), which can reduce the \ac{SLL} at a cost of increasing the main beam width or at a cost of increasing the lobe-level past the secondary lobe. Such tapers attenuate by a constant and fixed amount the power transmitted by certain antenna elements. However, this matter will be left out of this thesis for conciseness, perhaps to be study in the future (Section \ref{sec:future-work}). Consequently, we form beams changing only phases across the beam-steering vector. Realistic antenna arrays with tenths, hundreds or even thousands of elements may use analogue phase-shifters to beamform at RF frequencies instead of doing it digitally at BB, for cost reasons.
\end{comment}

One popular concern, despite not justified by research, is that analogue phase-shifters are not fast enough switching phases. However, the use of phase-shifters for beam-scanning has been widely used in \ac{RADAR} applications with switching times on the order of nanoseconds \cite{volakis}. Addressing now concerns supported by science, high insertion loss \cite{beam_steering_techniques}, i.e. insertion loss is ..., constitutes the main impairment. The loss grows with frequency, having values of X dBs at Y GHz. This is not a problem because %find a paper that shows this is converging or that the loss is small enough for the frequencies we are considering

% The insertion loss is accounted in the noise figure.


% ARGUMENT FOR CONVENTIONAL BEAM STEERING REMOVED FROM HERE.
This performance gap is justified by a significant reduction in hardware costs \cite{7010533}. Furthermore, the use of analogue phase-shifters and conventional beam-steering has been used in other cases, e.g. Wang's 60 GHz beamforming protocol adopted by IEEE 802.15.3c \cite{5262295}, and is accepted by the research community.

Research on other innovative ways of further reducing the costs in hardware has been conducted, e.g. Zhang suggested replacing phase-shifters by on-off switches and turn off some strategically picked antennas to form beams \cite{8246591}, but such approaches are still too experimental and not as widely accepted as the the century-old technique of conventional beam-steering \cite{6591907}.

% lambda/2 is fairly standard




% like marzeta said, with infinite antennas the problems get very small
% however, the only way of supporting such high densification of antennas is 
% to have a scalable approach to beamforming, which will not be the case when requiring a full digital chain per antenna element. Analogue phase-shifters are orders of magnitude smaller than a 30 GHz wavelength \todo{cite}


% Marzetta's main problem was with pilot contamination, something that will only get worse with increase in densification, especially if each UE uses all the pilots it is allowed.


% many papers proposed solutions to pilot reuse, but despite improving the performance, it still places a threshold on what is achievable.
% https://ieeexplore.ieee.org/document/7247312
% https://ieeexplore.ieee.org/document/6677139
% https://ieeexplore.ieee.org/document/7045498
% https://ieeexplore.ieee.org/document/7037313



% 10 years ago the resolution was down to 22ยบ: https://ieeexplore.ieee.org/document/4681839
% And current insertion losses: 


% The direction appears to be favourable, taking into account that there are 
% already thousand elements arrays, and those require at least as many analogue phase shifters as there are elements.
% https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8947954


% The point with only changing phases is that you can do that with phase
% shifters only, it is not required a full digital chain after that


% BUUUUUT all this argument falls flat since this is just beamforming! 
% full digital chains would still be required or else only one beam would be possible
% per antenna array since all phases would be the same.


% phases only also facilitates the power control algorithms because all antennas transmit with the same power always, which in beam forming schemes where the amplitudes of the weights change, when transmitting to multiples users it is necessary to make sure there is on power (amplifier) saturation in any antenna due to the accumulation of weights with high amplitude in that element.